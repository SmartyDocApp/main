# Smarty database schema documentation

## Overview
Smarty uses a hybrid data storage approach with MySQL for structured metadata and MongoDB for document content storage. This README describes the relational database schema used for the structured data portion.
The schema is designed to support:

- Personal document management
- Collaborative workspaces
- Bidirectional document sharing
- Note-taking and organization
- Chat functionality
- Tag-based organization

## Entity Relationship Diagram

erDiagram
    USER ||--o{ WORKSPACE_USER : "belongs to"
    USER ||--o{ DOCUMENT : "owns"
    USER ||--o{ FOLDER : "owns"
    USER ||--o{ CONTACT : "has"
    USER ||--o{ CHAT_MESSAGE : "sends"
    USER ||--o{ NOTE : "creates"
    
    WORKSPACE ||--o{ WORKSPACE_USER : "has"
    WORKSPACE ||--o{ DOCUMENT : "contains"
    WORKSPACE ||--o{ CHAT_MESSAGE : "contains"
    WORKSPACE ||--o{ NOTE : "contains"
    
    NOTEBOOK ||--o{ NOTE : "organizes"
    USER ||--o{ NOTEBOOK : "owns"
    WORKSPACE ||--o{ NOTEBOOK : "contains"
    
    NOTE }o--o{ TAG : "has"
    DOCUMENT }o--o{ TAG : "has"
    
    USER {
        string id PK
        string username
        datetime created_at
        string email
    }

    CONTACT {
        string id PK
        string user_id FK
        string contact_user_id FK
        datetime added_at
    }

    FOLDER {
        string id PK
        string user_id FK
        string name
        datetime created_at
    }

    DOCUMENT {
        string id PK
        string name
        string type
        text content
        string user_id FK
        string folder_id FK
        string workspace_id FK
        datetime created_at
        datetime updated_at
    }

    WORKSPACE {
        string id PK
        string name
        text description
        boolean has_chat_enabled
        string created_by FK
        datetime created_at
    }

    WORKSPACE_USER {
        string id PK
        string user_id FK
        string workspace_id FK
        string permission_level
    }

    CHAT_MESSAGE {
        string id PK
        string user_id FK
        string workspace_id FK
        text content
        datetime sent_at
    }
    
    NOTE {
        string id PK
        string title
        text content
        string preview_text
        string user_id FK
        string workspace_id FK "null if personal"
        string notebook_id FK
        boolean is_pinned
        boolean is_favorite
        datetime created_at
        datetime updated_at
    }
    
    NOTEBOOK {
        string id PK
        string name
        string user_id FK
        string workspace_id FK "null if personal"
        text description
        string color_code
        datetime created_at
        datetime updated_at
    }
    
    TAG {
        string id PK
        string name
        string color_code
        string user_id FK "creator"
    }
    
    NOTE_TAG {
        string id PK
        string note_id FK
        string tag_id FK
    }
    
    DOCUMENT_TAG {
        string id PK
        string document_id FK
        string tag_id FK
    }



